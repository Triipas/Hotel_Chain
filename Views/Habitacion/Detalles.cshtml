@model Hotel_chain.Models.Entities.Habitacion
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    ViewData["Title"] = "Detalle de Habitación";
}

<link rel="stylesheet" href="~/client/css/main.css">

<header>
    <nav class="navbar">
        <div class="logo">Costa Dorada</div>
        <div class="nav-derecha">
            <ul class="nav-links">
                <li><a asp-controller="Hotel" asp-action="Index">Home</a></li>
                <li><a asp-controller="Hotel" asp-action="Index">Hoteles</a></li>
                <li><a asp-controller="Habitacion" asp-action="Index" asp-route-hotelId="@Model.HotelId">Habitaciones</a></li>
                <li><a href="#">Sobre Nosotros</a></li>
                <li><a href="#">Contáctanos</a></li>
            </ul>

            @if (HttpContextAccessor.HttpContext.Session.GetString("UsuarioNombre") != null)
            {
                <span>Bienvenido, @HttpContextAccessor.HttpContext.Session.GetString("UsuarioNombre")</span>
                <a asp-controller="Login" asp-action="Logout"><button>Cerrar Sesión</button></a>
            }
            else
            {
                <a asp-controller="Login" asp-action="Index"><button class="login-btn">Ingresar</button></a>
            }
        </div>
    </nav>
</header>

<main class="container">
    <h2>Habitación @Model.NumeroHabitacion</h2>

    <div class="habitacion-detalle">
        <div class="imagenes-habitacion">
            @if(Model.Imagenes != null && Model.Imagenes.Any())
            {
                foreach(var img in Model.Imagenes)
                {
                    <img src="~/client/imagenes/@img.NombreArchivo" alt="@Model.NumeroHabitacion" class="habitacion-img" />
                }
            }
            else
            {
                <p>No hay imágenes disponibles.</p>
            }
        </div>

        <div class="info-habitacion">
            <p><strong>Tipo:</strong> @Model.Tipo</p>
            <p><strong>Capacidad:</strong> @Model.Capacidad personas</p>
            <p><strong>Precio por noche:</strong> S/ @Model.PrecioNoche</p>
            <p><strong>Descripción:</strong> @Model.Descripcion</p>

            @if(HttpContextAccessor.HttpContext.Session.GetString("UsuarioNombre") != null)
            {
                <form asp-controller="Reservas" asp-action="IniciarReserva" method="post">
                    <input type="hidden" name="habitacionId" value="@Model.HabitacionId" />
                    <input type="hidden" name="usuarioId" value="@HttpContextAccessor.HttpContext.Session.GetString("UsuarioId")" />
                    <button type="submit" class="btn-reservar">Reservar</button>
                </form>
            }
            else
            {
                <a asp-controller="Login" asp-action="Index" class="btn-reservar">
                    Inicia sesión para reservar
                </a>
            }
        </div>
    </div>

    <a asp-controller="Habitacion" asp-action="Index" asp-route-hotelId="@Model.HotelId" class="btn-volver">← Volver a Habitaciones</a>
</main>
