@model Hotel_chain.Models.Habitacion
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    ViewData["Title"] = "Detalle de Habitación";
}

<header>
    <nav class="navbar">
        <div class="logo">StayGo</div>
        <div class="nav-derecha">
            <ul class="nav-links">
                <li><a asp-controller="Hotel" asp-action="Index">Home</a></li>
                <li><a asp-controller="Hotel" asp-action="Index">Hoteles</a></li>
                <li><a asp-controller="Habitacion" asp-action="Index" asp-route-hotelId="@Model.HotelId">Habitaciones</a></li>
                <li><a href="#">Sobre Nosotros</a></li>
                <li><a href="#">Contáctanos</a></li>
            </ul>

            @if (HttpContextAccessor.HttpContext.Session.GetString("UsuarioNombre") != null)
            {
                <span>Bienvenido, @HttpContextAccessor.HttpContext.Session.GetString("UsuarioNombre")</span>
                <a asp-controller="Login" asp-action="Logout"><button>Cerrar Sesión</button></a>
            }
            else
            {
                <a asp-controller="Login" asp-action="Index"><button class="login-btn">Ingresar</button></a>
            }
        </div>
    </nav>
</header>

<link rel="stylesheet" href="~/css/style.css" />

<main class="container">
    <h2>Habitación @Model.NumeroHabitacion</h2>

    <div class="habitacion-detalle">
        <div class="imagenes-habitacion">
            @if(Model.Imagenes != null && Model.Imagenes.Any())
            {
                foreach(var img in Model.Imagenes)
                {
                    <img src="~/imagenes/@img.NombreArchivo" alt="@Model.NumeroHabitacion" class="habitacion-img" />
                }
            }
            else
            {
                <p>No hay imágenes disponibles.</p>
            }
        </div>

        <div class="info-habitacion">
            <p><strong>Tipo:</strong> @Model.Tipo</p>
            <p><strong>Capacidad:</strong> @Model.Capacidad personas</p>
            <p><strong>Precio por noche:</strong> S/ @Model.PrecioNoche</p>
            <p><strong>Descripción:</strong> @Model.Descripcion</p>

            @if(HttpContextAccessor.HttpContext.Session.GetString("UsuarioNombre") != null)
            {
                <form asp-controller="Home" asp-action="Reservar" method="post">
                    <input type="hidden" name="habitacionId" value="@Model.HabitacionId" />
                    <input type="hidden" name="usuarioId" value="@HttpContextAccessor.HttpContext.Session.GetString("UsuarioId")" />
                    <button type="submit" class="btn-reservar">Reservar</button>
                </form>
            }
            else
            {
                <a asp-controller="Login" asp-action="Index" class="btn-reservar">
                    Inicia sesión para reservar
                </a>
            }
        </div>
    </div>

    <a asp-controller="Habitacion" asp-action="Index" asp-route-hotelId="@Model.HotelId" class="btn-volver">← Volver a Habitaciones</a>
</main>

<style>
.habitacion-detalle {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-top: 20px;
}

.imagenes-habitacion {
    flex: 2;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.imagenes-habitacion img {
    width: calc(33% - 10px);
    height: 200px;
    object-fit: cover;
    border-radius: 8px;
}

.info-habitacion {
    flex: 1;
    background-color: #f9f9f9;
    padding: 15px;
    border-radius: 8px;
}

.info-habitacion p {
    margin: 10px 0;
}

.btn-reservar {
    margin-top: 15px;
    padding: 10px 15px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    display: inline-block;
    text-decoration: none;
}

.btn-volver {
    margin-top: 20px;
    display: inline-block;
}
</style>